import { useMedia } from './chunk-3ULVZKKX.js';
import { signal, effect, peek } from 'maverick.js';
import { defineCustomElement, onAttach } from 'maverick.js/element';

var OutletDefinition = defineCustomElement({
  tagName: "media-outlet",
  setup({ host }) {
    const context = useMedia(), $rendered = signal(false);
    onAttach(() => {
      host.el.keepAlive = true;
    });
    effect(() => {
      context.$loader();
      return () => $rendered.set(false);
    });
    effect(() => {
      const loader = context.$loader();
      if (!$rendered() || !loader)
        return;
      peek(() => {
        loader.load(context).then((provider) => {
          if (peek(context.$loader) === loader) {
            context.delegate.dispatch("provider-change", {
              detail: provider
            });
          }
        });
      });
    });
    return () => () => {
      var _a;
      $rendered.set(true);
      return (_a = context.$loader()) == null ? void 0 : _a.render(context.$store);
    };
  }
});

export { OutletDefinition };
